<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>结合官方文档 入门Flask | ieblYang</title>
        <meta name="Description" content="结合官方文档 入门Flask"><meta property="og:title" content="结合官方文档 入门Flask" />
<meta property="og:description" content="结合官方文档 入门Flask" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ieblyang.tech/en/flask01/" />
<meta property="article:published_time" content="2020-03-13T17:33:40+08:00" />
<meta property="article:modified_time" content="2020-03-13T17:33:40+08:00" /><meta property="og:site_name" content="ieblYang" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="结合官方文档 入门Flask"/>
<meta name="twitter:description" content="结合官方文档 入门Flask"/>
<meta name="theme-color" content="#ffffff">
<meta name="msapplication-TileColor" content="#da532c">
<link rel="canonical" href="https://ieblyang.tech/en/flask01/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="prev" href="https://ieblyang.tech/en/face06/" /><link rel="next" href="https://ieblyang.tech/en/face09/" /><link rel="stylesheet" href="/lib/fontawesome-free/all.min.9679f10076c3db0a03c8c8a5128dba53.css" integrity="md5-lnnxAHbD2woDyMilEo26Uw=="><link rel="stylesheet" href="/lib/animate/animate.min.bc1a6a99c43f5ccc97d2d350bde13f74.css" integrity="md5-vBpqmcQ/XMyX0tNQveE/dA=="><link rel="stylesheet" href="/css/style.min.ae21e349d7dcddfd942a94491d8158d5.css" integrity="md5-riHjSdfc3f2UKpRJHYFY1Q=="><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "结合官方文档 入门Flask",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/ieblyang.tech\/en\/flask01\/"
        },"image": {
                "@type": "ImageObject",
                "url": "https:\/\/ieblyang.tech\/cover.png",
                "width":  800 ,
                "height":  600 
            },"genre": "posts","keywords": "Python, Flask","wordcount":  1761 ,
        "url": "https:\/\/ieblyang.tech\/en\/flask01\/","datePublished": "2020-03-13","dateModified": "2020-03-13","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
                "@type": "Organization",
                "name": "ieblYang",
                "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/ieblyang.tech\/logo.png",
                "width":  127 ,
                "height":  40 
                }
            },"author": {
                "@type": "Person",
                "name": "ieblYang"
            },"description": "结合官方文档 入门Flask"
    }
    </script></head>
    <body><script>
            if (!window.localStorage || !window.localStorage.getItem('theme')) {window.isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;} else {
                window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            }
            window.isDark && document.body.classList.add('dark-theme');
        </script><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/en/">ieblYang</a>
        </div>
        <div class="menu"><a class="menu-item" href="/en/posts/" rel="noopener noreffer">Posts</a><a class="menu-item" href="/en/tags/" rel="noopener noreffer">Tags</a><a class="menu-item" href="/en/categories/" rel="noopener noreffer">Categories</a><a class="menu-item" href="/en/categories/documentation/" rel="noopener noreffer">Documentation</a><a class="menu-item" href="/en/about/" rel="noopener noreffer">About</a><a class="menu-item" href="https://github.com/ieblYang" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><span class="menu-item">|</span>
            <a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/en/flask01/" selected>English</option><option value="/flask01/">简体中文</option></select>
                </a></div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-wrapper">
        <div class="header-container">
            <div class="header-title">
                <a href="/en/">ieblYang</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/en/posts/" title="" rel="noopener noreffer">Posts</a><a class="menu-item" href="/en/tags/" title="" rel="noopener noreffer">Tags</a><a class="menu-item" href="/en/categories/" title="" rel="noopener noreffer">Categories</a><a class="menu-item" href="/en/categories/documentation/" title="" rel="noopener noreffer">Documentation</a><a class="menu-item" href="/en/about/" title="" rel="noopener noreffer">About</a><a class="menu-item" href="https://github.com/ieblYang" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/en/flask01/" selected>English</option><option value="/flask01/">简体中文</option></select>
                </a></div>
    </div>
</header>

<script>
    window.desktopHeaderMode = "fixed";
    window.mobileHeaderMode = "auto";
</script>
<main class="main">
                <div class="container"><article class="page single"><h1 class="single-title animated flipInX">结合官方文档 入门Flask</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://ieblyang.github.io/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>ieblYang</a>
</span>&nbsp;
                    <span class="post-category">included in<a href="/en/categories/flask">
                                <i class="far fa-folder fa-fw"></i>Flask
                            </a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i><time datetime=2020-03-13>2020-03-13</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 1761 words&nbsp;
                <i class="far fa-clock fa-fw"></i>9 min&nbsp;<span id="/en/flask01/" class="leancloud_visitors" data-flag-title="结合官方文档 入门Flask">
                        <i class="far fa-eye fa-fw"></i><span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-sizes="auto"
        data-srcset="/images/flask/featured-image.png, /images/flask/featured-image.png 1.5x, /images/flask/featured-image.png 2x"
        data-src="/images/flask/featured-image.png"
        alt="结合官方文档 入门Flask"
        title="结合官方文档 入门Flask" /></div><div class="toc" id="toc-auto">
                <h2 class="toc-title">Contents</h2>
                <div class="toc-content" id="toc-content-auto"></div>
            </div>
            <div class="toc" id="toc-static">
                <details>
                    <summary>
                        <div class="toc-title">
                            <span>Contents</span>
                            <span><i class="details icon fas fa-angle-down"></i></span>
                        </div>
                    </summary>
                    <div class="toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-flask介绍">1 Flask介绍</a>
      <ul>
        <li><a href="#11-简介">1.1 简介</a></li>
        <li><a href="#12-流行原因">1.2 流行原因</a></li>
        <li><a href="#13-mvcmodel-view-controller设计模式">1.3 MVC(Model, View, Controller)设计模式</a></li>
      </ul>
    </li>
    <li><a href="#2-安装linux">2 安装（Linux）</a>
      <ul>
        <li><a href="#21-创建一个虚拟环境">2.1 创建一个虚拟环境</a></li>
        <li><a href="#22-激活虚拟环境">2.2 激活虚拟环境</a></li>
        <li><a href="#23-安装flask">2.3 安装Flask</a></li>
        <li><a href="#24-安装virtualenv">2.4 安装virtualenv</a></li>
      </ul>
    </li>
    <li><a href="#3-hello-world">3 Hello World</a></li>
    <li><a href="#4-参数配置">4 参数配置</a>
      <ul>
        <li><a href="#41-利用apprun配置">4.1 利用app.run（）配置</a></li>
        <li><a href="#42-使用configpy配置文件">4.2 使用<code>config.py</code>配置文件</a></li>
        <li><a href="#43-使用flask-script插件配置">4.3 使用flask-script插件配置</a>
          <ul>
            <li><a href="#431-安装使用">4.3.1 安装使用</a></li>
            <li><a href="#432-参数使用">4.3.2 参数使用</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#5-请求流程">5 请求流程</a></li>
    <li><a href="#6-路由">6 路由</a>
      <ul>
        <li><a href="#61-变量规则">6.1 变量规则</a></li>
        <li><a href="#62-唯一的url--重定向行为">6.2 唯一的URL / 重定向行为</a></li>
        <li><a href="#63-反向解析">6.3 反向解析</a></li>
        <li><a href="#64-http-方法">6.4 HTTP 方法</a></li>
      </ul>
    </li>
    <li><a href="#7-静态文件">7 静态文件</a></li>
    <li><a href="#8-模板">8 模板</a>
      <ul>
        <li><a href="#81-jinja2">8.1 Jinja2</a></li>
        <li><a href="#82-模板语法">8.2 模板语法</a>
          <ul>
            <li><a href="#821-变量">8.2.1 变量</a></li>
            <li><a href="#822-标签">8.2.2 标签</a></li>
          </ul>
        </li>
        <li><a href="#83-结构标签">8.3 结构标签</a>
          <ul>
            <li><a href="#831-block">8.3.1 block</a></li>
            <li><a href="#832-extends">8.3.2 extends</a></li>
            <li><a href="#833-include">8.3.3 include</a></li>
            <li><a href="#834-marco">8.3.4 marco</a></li>
          </ul>
        </li>
        <li><a href="#84-for-循环">8.4 for 循环</a></li>
        <li><a href="#85-过滤器">8.5 过滤器</a></li>
        <li><a href="#86-flask-bootstrap">8.6 Flask-Bootstrap</a>
          <ul>
            <li><a href="#861-安装">8.6.1 安装</a></li>
            <li><a href="#862-导入和加载扩展">8.6.2 导入和加载扩展</a></li>
            <li><a href="#862-创建基于bootstrap的模板">8.6.2 创建基于Bootstrap的模板</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#9-request">9 Request</a></li>
    <li><a href="#10-response">10 Response</a></li>
    <li><a href="#11-重定向和错误">11 重定向和错误</a></li>
    <li><a href="#12-json">12 JSON</a></li>
    <li><a href="#13-蓝图">13 蓝图</a>
      <ul>
        <li><a href="#131-插件安装">13.1 插件安装</a></li>
        <li><a href="#132-初始化蓝图">13.2 初始化蓝图</a></li>
      </ul>
    </li>
    <li><a href="#14-cookie">14 Cookie</a></li>
    <li><a href="#15-session">15 Session</a>
      <ul>
        <li><a href="#151-session使用">15.1 Session使用</a></li>
        <li><a href="#152-flask-session插件">15.2 Flask-Session插件</a></li>
      </ul>
    </li>
    <li><a href="#16-消息闪现">16 消息闪现</a></li>
    <li><a href="#17-登录示例">17 登录示例</a></li>
  </ul>
</nav></div>
                </details>
            </div><div class="content" id="content"><p>结合Flask官方中文文档，学习Flask基础入门知识</p>
<h2 id="1-flask介绍">1 Flask介绍</h2>
<h3 id="11-简介">1.1 简介</h3>
<ul>
<li>
<p>Flask是一个基于Python实现的Web开发‘微’框架</p>
<ul>
<li>官方文档：<a href="http://flask.pocoo.org/docs/0.12/">http://flask.pocoo.org/docs/0.12/</a></li>
<li>中文文档：<a href="http://docs.jinkan.org/docs/flask/">http://docs.jinkan.org/docs/flask/</a></li>
</ul>
</li>
<li>
<p>Flask和Django一样，也是一个基于MVC设计模式的Web框架</p>
</li>
<li>
<p>Flask依赖三个库</p>
<ul>
<li>Jinja2 模板引擎</li>
<li>Werkzeug WSGI工具集</li>
<li>Itsdangerous基于Django的签名模块</li>
</ul>
</li>
</ul>
<h3 id="12-流行原因">1.2 流行原因</h3>
<ul>
<li>有非常齐全的官方文档，上手非常简单</li>
<li>有非常好的扩展机制和第三方扩展环境，工作中常见的软件都会有对应的扩展。自己动手实现扩展也很容易</li>
<li>社区活跃度非常高</li>
<li>微信框架的形式给开发者带来更大的选择空间</li>
</ul>
<h3 id="13-mvcmodel-view-controller设计模式">1.3 MVC(Model, View, Controller)设计模式</h3>
<p>一种软件设计典范，用一种业务逻辑，使数据，界面显示分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进和个性化定制界面与用户交互的同时，不需要重新编写业务逻辑。</p>
<ul>
<li>MVC被独特的发展起来用于映射传统的输入，处理和输出功能在一个逻辑的图形化界面结构中。</li>
<li>核心思想：解耦</li>
<li>优点：降低各模块之间的耦合性，方便变更，更容易重构代码，最大程度实现了代码的重用。</li>
<li>Model:用于封装与应用程序的业务逻辑相关的数据及对数据的处理方法，是Web应用程序中用于处理应用程序的数据逻辑部分，Model通常只提供功能性的接口，通过这些接口可以获取Model的所有功能。</li>
<li>View:负责数据的显示和呈现，View是对用户 的直接输出。</li>
<li>Controller:负贵从用户端收集用户的输入，可以看成提供View的反向功能，主要处理用户交互。</li>
</ul>
<h2 id="2-安装linux">2 安装（Linux）</h2>
<h3 id="21-创建一个虚拟环境">2.1 创建一个虚拟环境</h3>
<p>创建一个项目文件夹，然后创建一个虚拟环境。创建完成项目文件夹中会有一个<code>venv</code>文件夹：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Bash" data-lang="Bash">mkdir myproject
<span class="nb">cd</span> myproject
python3 -m venv venv
</code></pre></td></tr></table>
</div>
</div><h3 id="22-激活虚拟环境">2.2 激活虚拟环境</h3>
<p>在开始工作前，先要激活响应的虚拟环境：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Bash" data-lang="Bash">.venv/bin/activate
</code></pre></td></tr></table>
</div>
</div><h3 id="23-安装flask">2.3 安装Flask</h3>
<p>在已激活的虚拟环境中可以使用如下命令安装Flask：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Bash" data-lang="Bash">pip3 install Flask
</code></pre></td></tr></table>
</div>
</div><h3 id="24-安装virtualenv">2.4 安装virtualenv</h3>
<p>在Linux下，virtualenv 通过操作系统的包管理安装：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Bash" data-lang="Bash"><span class="c1"># Debian,Ubuntu</span>
sudo apt-get install python-virtualenv
</code></pre></td></tr></table>
</div>
</div><h2 id="3-hello-world">3 Hello World</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
	<span class="k">return</span> <span class="s1">&#39;Hello,World!&#39;</span>
	
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
	<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><div class="admonition note">
            <p class="admonition-title"><i class="icon fas fa-pencil-alt"></i>笔记</p>
            <div class="admonition-content"><ul>
<li>首先导入了<code>Flask</code>类。 该类的实例将会成为WSGI应用。</li>
<li>接着创建一个该类的实例。第一个参数是应用模块或者包的名称。如果使用一个单一模块(就像本例),
那么应当使用 <code>name</code> ，因为名称会根据这个模块是按应用方式使用还是作为一个模块导入而发生变化(可能
是 &lsquo;main&rsquo; ，也可能是实际导入的名称)。这个参数是必需的，这样 Flask 才能知道在哪里可以找到模板和
静态文件等东西。</li>
<li>然后使用 <code>route()</code> 装饰器来告诉 Flask 触发函数的 URL 。</li>
<li>函数名称被用于生成相关联的URL。函数最后返回需要在用户浏览器中显示的信息。
把它保存为 <code>hello. py</code> 或其他类似名称。不要使用<code>flask.py</code>作为应用名称，这会与 Flask 本身发生冲突。</li>
</ul>
</div>
        </div>
<h2 id="4-参数配置">4 参数配置</h2>
<h3 id="41-利用apprun配置">4.1 利用app.run（）配置</h3>
<ul>
<li>在启动的时候还可以添加参数，在 <code>run()</code> 中</li>
<li>debug 是否开启调试模式，开启后修改过python代码会自动重启</li>
<li>threaded 是否开启多线程</li>
<li>port 启动指定服务器的端口号</li>
<li>host 主机，默认是127.0.0.1，指定为0.0.0.0代表本机所有ip</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
	<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="42-使用configpy配置文件">4.2 使用<code>config.py</code>配置文件</h3>
<ul>
<li>新建<code>config.py</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># 以DEBUG为例</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>载入配置文件</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>配置文件读取</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;DEBUG&#39;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="admonition abstract">
            <p class="admonition-title"><i class="icon fas fa-list-ul"></i>重要</p>
            <div class="admonition-content"><ul>
<li><code>app.config.from_object('config')</code> 载入配置文件，使用时<code>DEBUG</code>必须大写</li>
<li>config 配置文件中的参数必须全部大写</li>
<li><code>DEBUG</code> 的值默认值为 False</li>
</ul>
</div>
        </div>
<h3 id="43-使用flask-script插件配置">4.3 使用flask-script插件配置</h3>
<h4 id="431-安装使用">4.3.1 安装使用</h4>
<ul>
<li>安装</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Bash" data-lang="Bash">pip3 install flask-script
</code></pre></td></tr></table>
</div>
</div><ul>
<li>使用app构建manager对象</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">manager</span> <span class="o">=</span> <span class="n">Manager</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>使用manager启动程序</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">manager</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="432-参数使用">4.3.2 参数使用</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">-d		#是否开启调试模式
-r 		#是否自动重新加载文件
-h, -host #指定主机
-p, -port	#指定端口
-threaded	#是否使用多线程
-?, -help	#查看帮助
#示例：
python3 manage.py runserver --help
</code></pre></td></tr></table>
</div>
</div><h2 id="5-请求流程">5 请求流程</h2>
<p><img
        class="lazyload"
        src="/svg/loading.small.min.svg"
        data-sizes="auto"
        data-srcset="/images/flask/flask01/1.jpg,  1.5x,  2x"
        data-src=""
        alt="Minion"
        title="Minion" /></p>
<h2 id="6-路由">6 路由</h2>
<p>路由：将从客户端发送过来的请求分发到指定函数上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
	<span class="k">return</span> <span class="s1">&#39;Index Page&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hello&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
	<span class="k">return</span> <span class="s1">&#39;Hello,World&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="61-变量规则">6.1 变量规则</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/user/&lt;username&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_user_profile</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
	<span class="c1"># show the user profile for that user</span>
	<span class="k">return</span> <span class="s1">&#39;User </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">escape</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/post/&lt;int:post_id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_post</span><span class="p">(</span><span class="n">post_id</span><span class="p">):</span>
	<span class="c1"># show the post with the given id, the id is an integer</span>
	<span class="k">return</span> <span class="s1">&#39;Post </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">post_id</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/path/&lt;path:subpath&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_subpath</span><span class="p">(</span><span class="n">subpath</span><span class="p">):</span>
	<span class="c1"># show the subpath after /path/</span>
	<span class="k">return</span> <span class="s1">&#39;Subpath </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">escape</span><span class="p">(</span><span class="n">subpath</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="admonition note">
            <p class="admonition-title"><i class="icon fas fa-pencil-alt"></i>笔记</p>
            <div class="admonition-content"><p>参数</p>
<ul>
<li>路径参数
<ul>
<li>位置参数</li>
<li>关键字参数</li>
</ul>
</li>
<li>请求参数
<ul>
<li>get 参数在路径中？之后</li>
<li>post参数在请求体中
Flask中参数</li>
</ul>
</li>
<li>都是关键字参数</li>
<li>默认标识是<code>&lt;&gt;</code></li>
<li>name需要和对应的视图函数的参数名字保持一致</li>
<li>参数允许有默认值
<ul>
<li>如果有默认值，那么在路由中，不传输参数也可以</li>
<li>如果没有默认值，参数在路由中必须传递</li>
</ul>
</li>
<li>默认参数类型是字符串,写法 <code>&lt;converter:variable_name&gt;</code></li>
<li>converter类型
<ul>
<li>string 默认值，会将<code>/</code>认为是参数分割符</li>
<li>int 接收整型</li>
<li>float 接收浮点型</li>
<li>path 接收到的数据格式是字符串，会将斜线<code>/</code>认为是一个字符</li>
<li>uuid 只接收uuid字符串，唯一码，一种生成规则</li>
<li>any 列出的元组中的任意一个</li>
</ul>
</li>
</ul>
</div>
        </div>
<h3 id="62-唯一的url--重定向行为">6.2 唯一的URL / 重定向行为</h3>
<p>以下的两条规则的不同之处在于是否使用尾部的<code>/</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/projects/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">projects</span><span class="p">():</span>
	<span class="k">return</span> <span class="s1">&#39;The project page&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/about&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">about</span><span class="p">():</span>
	<span class="k">return</span> <span class="s1">&#39;The about page&#39;</span>
</code></pre></td></tr></table>
</div>
</div><div class="admonition note">
            <p class="admonition-title"><i class="icon fas fa-pencil-alt"></i>笔记</p>
            <div class="admonition-content"><ul>
<li>
<p><code>projects</code> 的 URL 是中规中矩的，尾部有一个斜杠，看起来就如同一个文件夹。 访问一个没有斜杠结尾的 URL 时 Flask 会自动进行重定向，在尾部加上一个斜杠。</p>
</li>
<li>
<p><code>about</code> 的 URL 没有尾部斜杠，因此其行为表现与一个文件类似。如果访问这个 URL 时添加了尾部斜杠就会得到一个 404 错误。这样可以保持 URL 唯一，并帮助 搜索引擎避免重复索引同一页面。</p>
</li>
</ul>
</div>
        </div>
<h3 id="63-反向解析">6.3 反向解析</h3>
<p><code>url_for('函数名',参数名=value)</code></p>
<ul>
<li>
<p>根据endpoint获取到对应的路径</p>
</li>
<li>
<p>endpoint默认就是函数的名字</p>
</li>
<li>
<p>如果有参数 url_for(&lsquo;函数名&rsquo;,key=value,key=value)</p>
</li>
<li>
<p>反向解析在模板上可以直接使用</p>
</li>
<li>
<p>使用在app中</p>
<ul>
<li>url_for(&lsquo;endpoint&rsquo;)</li>
<li>endpoint 默认是函数名字</li>
</ul>
</li>
<li>
<p>使用在blueprint中</p>
<ul>
<li>url_for(&lsquo;bluename.endpoint&rsquo;)</li>
<li>蓝图名字.函数名</li>
</ul>
</li>
<li>
<p>获取静态资源路径</p>
<ul>
<li>url_for(&lsquo;static&rsquo;,filename=&lsquo;path&rsquo;)</li>
<li>static 资源</li>
<li>path 相对于资源的路径</li>
</ul>
</li>
</ul>
<div class="admonition note">
            <p class="admonition-title"><i class="icon fas fa-pencil-alt"></i>笔记</p>
            <div class="admonition-content"><p>为什么不在把 URL 写死在模板中，而要使用反转函数 <code>url_for()</code> 动态构建？</p>
<ul>
<li>反转通常比硬编码 URL 的描述性更好。</li>
<li>可以只在一个地方改变 URL ，而不用到处乱找。</li>
<li>URL 创建会为你处理特殊字符的转义和 Unicode 数据，比较直观。</li>
<li>生产的路径总是绝对路径，可以避免相对路径产生副作用。</li>
<li>如果应用是放在 URL 根路径之外的地方（如在 <code>/myapplication</code> 中，不在 <code>/</code> 中）， <code>url_for()</code> 会妥善处理。</li>
</ul>
</div>
        </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">escape</span><span class="p">,</span> <span class="n">url_for</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;index&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;login&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/user/&lt;username&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;{}</span><span class="se">\&#39;</span><span class="s1">s profile&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">escape</span><span class="p">(</span><span class="n">username</span><span class="p">))</span>

<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="nb">next</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">))</span>
<span class="c1">#运行结果</span>
<span class="o">/</span>  
<span class="o">/</span><span class="n">login</span>  
<span class="o">/</span><span class="n">login</span><span class="err">?</span><span class="nb">next</span><span class="o">=/</span>  
<span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">John</span><span class="o">%</span><span class="mi">20</span><span class="n">Doe</span>  
</code></pre></td></tr></table>
</div>
</div><h3 id="64-http-方法">6.4 HTTP 方法</h3>
<p>Web 应用使用不同的 HTTP 方法处理 URL 。当你使用 Flask 时，应当熟悉 HTTP 方法。 缺省情况下，一个路由只回应 <code>GET</code> 请求。 可以使用 <code>route()</code> 装饰器的 <code>methods</code> 参数来处理不同的 HTTP 方法:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">do_the_login</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">show_the_login_form</span><span class="p">()</span>

</code></pre></td></tr></table>
</div>
</div><p>methods中指定请求方法</p>
<ul>
<li>GET</li>
<li>POST</li>
<li>HEAD</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
<h2 id="7-静态文件">7 静态文件</h2>
<p>动态的 web 应用也需要静态文件，一般是 CSS 和 JavaScript 理想情况下服务器已经配置好了提供静态文件的服务。但是在开发过程中， Flask 也能做好这项工作。只要在包或模块旁边创建一个名为 <code>static</code> 的文件夹就行了。 静态文件位于应用的 <code>/static</code> 中。<br>
使用特定的 &lsquo;static&rsquo; 端点就可以生成相应的 URL</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;style.css&#39;</span><span class="p">)</span>
<span class="c1"># 这个静态文件在文件系统中的位置应该是 static/style.css</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="8-模板">8 模板</h2>
<p>模板是呈现给用户的界面，在MVT中充当T的角色，实现了VT的解耦，开发中VT有着N:M的关系，一个V可以通用任意T，一个T可以被任意V调用。</p>
<ul>
<li>
<p>模板处理分为两个过程：</p>
<ul>
<li>加载</li>
<li>渲染</li>
</ul>
</li>
<li>
<p>模板代码包含两个部分：</p>
<ul>
<li>静态HTML</li>
<li>动态插入的代码段</li>
</ul>
</li>
</ul>
<p>Flask 会在 <code>templates</code> 文件夹内寻找模板。因此，如果应用是一个模块， 那么模板文件夹应该在模块旁边；如果是一个包，那么就应该在包里面：</p>
<ul>
<li>情形 1 : 一个模块:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">/application.py
/templates
    /hello.html
</code></pre></td></tr></table>
</div>
</div><ul>
<li>情形 2 : 一个包:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">/application
    /__init__.py
    /templates
        /hello.html
</code></pre></td></tr></table>
</div>
</div><h3 id="81-jinja2">8.1 Jinja2</h3>
<p>Flask中使用Jinja2模板引擎
Jinja2由Flask作者开发</p>
<ul>
<li>
<p>一个现代化设计和友好的Python模板语言</p>
</li>
<li>
<p>模仿Django的模板引擎</p>
</li>
<li>
<p>优点：</p>
<ul>
<li>速度快，被广泛使用</li>
<li>HTML设计和后端Python分离</li>
<li>较少Python复杂度</li>
<li>非常灵活，快速和安全</li>
<li>提供了控制，继承等高级功能</li>
</ul>
</li>
<li>
<p>Flask 自动配置 Jinja2 模板引擎。</p>
</li>
</ul>
<p>使用 <code>render_template()</code>方法可以渲染模板，只要提供模板名称和需要作为参数传递给模板的变量就行了。下面是一个简单的模板渲染例子:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hello/&#39;</span><span class="p">)</span>
<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hello/&lt;name&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;hello.html&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="82-模板语法">8.2 模板语法</h3>
<p>模板语法主要分为两种：变量、标签</p>
<h4 id="821-变量">8.2.1 变量</h4>
<p>模板中的变量<code>{{ var }}</code></p>
<ul>
<li>视图传递给模板的数据</li>
<li>前面定义出来的数据</li>
<li>变量不存在，默认忽略</li>
</ul>
<h4 id="822-标签">8.2.2 标签</h4>
<p>模板中的标签<code>{% tag %}</code></p>
<ul>
<li>逻辑控制</li>
<li>使用外部表达式</li>
<li>创建变量</li>
<li>宏定义</li>
</ul>
<h3 id="83-结构标签">8.3 结构标签</h3>
<h4 id="831-block">8.3.1 block</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% block xxx %}
{% endblock %}
</code></pre></td></tr></table>
</div>
</div><ul>
<li>块操作</li>
<li>父模板挖坑，子模板填坑</li>
<li>首次出现挖坑，非首次填坑</li>
<li>多次填坑会出现覆盖，不想覆盖使用{{super()}}</li>
</ul>
<h4 id="832-extends">8.3.2 extends</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% extends &#39;xxx&#39; %}
<span class="c">&lt;!--继承后保留块中的内容--&gt;</span>
{{super()}}
</code></pre></td></tr></table>
</div>
</div><h4 id="833-include">8.3.3 include</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% include &#39;xxx&#39; %}
</code></pre></td></tr></table>
</div>
</div><ul>
<li>包含，将其他html包含进来，体现的是由零到一的概念</li>
<li>能用block + extends实现的，尽量不要使用include</li>
</ul>
<h4 id="834-marco">8.3.4 marco</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% marco hello(name) %}	
{% endmarco %}
{{name}}
</code></pre></td></tr></table>
</div>
</div><ul>
<li>宏定义，可以在html中定义函数</li>
<li>可以接收参数</li>
<li>通过调用函数生成html</li>
<li>支持导入操作</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% from xxx import yy %}
</code></pre></td></tr></table>
</div>
</div><h3 id="84-for-循环">8.4 for 循环</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% for item in cols %}
	AA
{% else %}
	BB
{% endfor %}
</code></pre></td></tr></table>
</div>
</div><ul>
<li>可以使用和Python一样的<code>for...else</code></li>
<li>也可以获取循环信息loop
<ul>
<li>loop.first</li>
<li>loop.last</li>
<li>loop.index</li>
<li>loop.index()</li>
<li>loop.revindex</li>
<li>loop.revindex()</li>
</ul>
</li>
</ul>
<h3 id="85-过滤器">8.5 过滤器</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{{变量|过滤器|过滤器...}}
</code></pre></td></tr></table>
</div>
</div><ul>
<li>过滤器并不是先写先执行</li>
<li>safe最后做</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>capitalize</td>
<td>驼峰命名</td>
</tr>
<tr>
<td>lower</td>
<td>变为小写</td>
</tr>
<tr>
<td>upper</td>
<td>变为大写</td>
</tr>
<tr>
<td>title</td>
<td>标题</td>
</tr>
<tr>
<td>trim</td>
<td>去掉空格</td>
</tr>
<tr>
<td>reverse</td>
<td>反转</td>
</tr>
<tr>
<td>format</td>
<td>格式化</td>
</tr>
<tr>
<td>striptags</td>
<td>渲染之前，将值中标签去掉</td>
</tr>
</tbody>
</table>
<h3 id="86-flask-bootstrap">8.6 Flask-Bootstrap</h3>
<p>官方文档：<a href="https://pythonhosted.org/Flask-Bootstrap/chinese_version.html" target="_blank" rel="noopener noreffer">Flask-Bootstrap</a>
</p>
<h4 id="861-安装">8.6.1 安装</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">pip3 install flask-bootstrap
</code></pre></td></tr></table>
</div>
</div><h4 id="862-导入和加载扩展">8.6.2 导入和加载扩展</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_bootstrap</span> <span class="kn">import</span> <span class="n">Bootstrap</span>

<span class="k">def</span> <span class="nf">create_app</span><span class="p">():</span>
  <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="n">Bootstrap</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">app</span>

<span class="c1"># do something with app...</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="862-创建基于bootstrap的模板">8.6.2 创建基于Bootstrap的模板</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% extends &#34;bootstrap/base.html&#34; %}
{% block title %}This is an example page{% endblock %}

{% block navbar %}
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;navbar navbar-fixed-top&#34;</span><span class="p">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
{% endblock %}

{% block content %}
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello, Bootstrap<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
{% endblock %}
</code></pre></td></tr></table>
</div>
</div><h2 id="9-request">9 Request</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/request&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">req</span><span class="p">():</span>
	<span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
	<span class="c1"># arguments 参数，get请求参数</span>
	<span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span>
	<span class="c1"># post 相关请求都会有数据</span>
	<span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">requset</span><span class="o">.</span><span class="n">cookies</span><span class="p">)</span>
	<span class="c1">#ip地址</span>
	<span class="k">print</span><span class="p">(</span><span class="n">requset</span><span class="o">.</span><span class="n">remote_addr</span><span class="p">)</span>
	<span class="c1"># 浏览器标识</span>
	<span class="k">print</span><span class="p">(</span><span class="n">requset</span><span class="o">.</span><span class="n">user_agent</span><span class="p">)</span>

	<span class="k">print</span><span class="p">(</span><span class="n">requset</span><span class="o">.</span><span class="n">user_url</span><span class="p">)</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="10-response">10 Response</h2>
<p>服务器返回给客户端的数据
由程序员创建，返回Response对象</p>
<ul>
<li>
<p>直接返回Response对象</p>
</li>
<li>
<p>通过make_response(data,code)</p>
<ul>
<li>-data 返回的数据内容</li>
<li>-code 状态码</li>
</ul>
</li>
<li>
<p>返回文本的内容，状态码</p>
</li>
<li>
<p>返回模板</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/response&#39;</span><span class="p">)</span>
<span class="n">def</span><span class="p">(</span><span class="n">resp</span><span class="p">):</span>
	
	<span class="n">result</span> <span class="o">=</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;hello.html&#39;</span><span class="p">)</span>
	
	<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
	
	<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

	<span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="s1">&#39;&lt;h3&gt;响应&lt;/h3&gt;&#39;</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span>

	<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

	<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

	<span class="k">return</span> <span class="n">response</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="11-重定向和错误">11 重定向和错误</h2>
<ul>
<li>redirect()</li>
<li>url_for(&lsquo;函数名&rsquo;,参数=value)</li>
<li>使用 <code>redirect()</code> 函数可以重定向。使用 <code>abort()</code> 可以更早退出请求，并返回错误代码:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">abort</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="n">abort</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
    <span class="n">this_is_never_executed</span><span class="p">()</span>

<span class="c1"># 上例实际上是没有意义的，它让一个用户从索引页重定向到一个无法访问的页面（401 表示禁止访问）。</span>
<span class="c1"># 但是上例可以说明重定向和出错跳出是如何工作的。</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>缺省情况下每种出错代码都会对应显示一个黑白的出错页面。使用 errorhandler() 装饰器可以定制出错页面:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>

<span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">page_not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;page_not_found.html&#39;</span><span class="p">),</span> <span class="mi">404</span>
<span class="c1">#注意 render_template() 后面的 404 ，这表示页面对应的出错 代码是 404 ，即页面不存在。缺省情况下 200 表示：一切正常。</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="12-json">12 JSON</h2>
<p>JSON 格式的响应是常见的，用 Flask 写这样的 API 是很容易上手的。如果从视图返回一个 <code>dict</code> ，那么它会被转换为一个 JSON 响应。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&#34;/me&#34;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">me_api</span><span class="p">():</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_current_user</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
        <span class="s2">&#34;theme&#34;</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">theme</span><span class="p">,</span>
        <span class="s2">&#34;image&#34;</span><span class="p">:</span> <span class="n">url_for</span><span class="p">(</span><span class="s2">&#34;user_image&#34;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">image</span><span class="p">),</span>
    <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>如果 <code>dict</code> 还不能满足需求，还需要创建其他类型的 JSON 格式响应，可以使用 <code>jsonify()</code> 函数。该函数会序列化任何支持的 JSON 数据类型。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&#34;/users&#34;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">users_api</span><span class="p">():</span>
    <span class="n">users</span> <span class="o">=</span> <span class="n">get_all_users</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">([</span><span class="n">user</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="13-蓝图">13 蓝图</h2>
<ul>
<li>Blueprint 是一种组织一组相关视图及其他代码的方式。与把视图及其他 代码直接注册到应用的方式不同，蓝图方式是把它们注册到蓝图，然后在工厂函数中把蓝图注册到应用。</li>
<li>flask中用来解决上帝文件问题，将请求从主文件中拆分到多个文件中。</li>
</ul>
<h3 id="131-插件安装">13.1 插件安装</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Bash" data-lang="Bash">pip3 install flask-blueprint
</code></pre></td></tr></table>
</div>
</div><h3 id="132-初始化蓝图">13.2 初始化蓝图</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># manager.py</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_script</span> <span class="kn">import</span> <span class="n">Manager</span>

<span class="kn">from</span> <span class="nn">App.views</span> <span class="kn">import</span> <span class="n">bp</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># 在app中注册</span>
<span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">blueprint</span><span class="o">=</span><span class="n">bp</span><span class="p">)</span>

<span class="n">manager</span> <span class="o">=</span> <span class="n">Manager</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span>
	<span class="n">manager</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># /App/views</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span>

<span class="c1"># 创建一个类，构造一个蓝图</span>
<span class="n">bp</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">&#39;bp&#39;</span><span class="p">,</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># 使用</span>
<span class="nd">@bp.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="n">def</span><span class="o">.</span><span class="n">hello</span><span class="p">():</span>
	<span class="k">return</span> <span class="s1">&#39;Hello Blueprint!&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="14-cookie">14 Cookie</h2>
<ul>
<li>
<p>客户端会话技术</p>
</li>
<li>
<p>数据都是存储在浏览器中</p>
</li>
<li>
<p>支持过期</p>
</li>
<li>
<p>不能跨域名</p>
</li>
<li>
<p>不能跨浏览器</p>
</li>
<li>
<p>cookie是通过Response来进行操作</p>
</li>
<li>
<p>flask中的cookie可以直接支持中文</p>
<ul>
<li>flask对cookie中的内容做了编码</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># 读取cookie</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
    <span class="c1"># use cookies.get(key) instead of cookies[key] to not get a</span>
    <span class="c1"># KeyError if the cookie is missing.</span>

<span class="c1"># 存储cookie</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">make_response</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">render_template</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;the username&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="15-session">15 Session</h2>
<ul>
<li>
<p>服务端会话技术</p>
</li>
<li>
<p>对数据进行数据安全操作</p>
</li>
<li>
<p>默认在内存中</p>
<ul>
<li>不容易管理</li>
<li>容易丢失</li>
<li>不能多台电脑协作</li>
</ul>
</li>
<li>
<p>Flask-Session 默认有效期31天</p>
</li>
</ul>
<h3 id="151-session使用">15.1 Session使用</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">escape</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># 使用会话之前必须设置一个密钥。</span>
<span class="c1"># Set the secret key to some random bytes. Keep this really secret!</span>
<span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;_5#y2L&#34;F4Q8z</span><span class="se">\n\xec</span><span class="s1">]/&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;username&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Logged in as </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">escape</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="s1">&#39;You are not logged in&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;&#39;
</span><span class="s1">        &lt;form method=&#34;post&#34;&gt;
</span><span class="s1">            &lt;p&gt;&lt;input type=text name=username&gt;
</span><span class="s1">            &lt;p&gt;&lt;input type=submit value=Login&gt;
</span><span class="s1">        &lt;/form&gt;
</span><span class="s1">    &#39;&#39;&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
    <span class="c1"># remove the username from the session if it&#39;s there</span>
    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="152-flask-session插件">15.2 Flask-Session插件</h3>
<p>官方文档：<a href="https://pythonhosted.org/Flask-Session/" target="_blank" rel="noopener noreffer">Flask-Session</a>
</p>
<ul>
<li>安装</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Bash" data-lang="Bash">pip3 install Flask-Session
</code></pre></td></tr></table>
</div>
</div><ul>
<li>使用</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">session</span>
<span class="kn">from</span> <span class="nn">flask.ext.session</span> <span class="kn">import</span> <span class="n">Session</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># Check Configuration section for more details</span>

<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SESSION_TYPE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;redis&#39;</span>
<span class="n">Session</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/set/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">set</span><span class="p">():</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;ok&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/get/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;not set&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="16-消息闪现">16 消息闪现</h2>
<ul>
<li>闪现系统的基本工作原理是在请求结束时记录一个消息，提供且只提供给下一个请求使用。通常通过一个布局模板来展现闪现的消息。</li>
<li><code>flash()</code> 用于闪现一个消息。在模板中，使用 get_flashed_messages() 来操作消息。</li>
</ul>
<h2 id="17-登录示例">17 登录示例</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">flash</span><span class="p">,</span><span class="n">session</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">escape</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Set the secret key to some random bytes. Keep this really secret!</span>
<span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;_5#y2L&#34;F4Q8z</span><span class="se">\n\xec</span><span class="s1">]/&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;username&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Logged in as </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">escape</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="s1">&#39;You are not logged in&#39;</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
    	 <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;admin&#39;</span> <span class="ow">or</span> \
           <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;secret&#39;</span><span class="p">:</span>
            <span class="n">flash</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Invalid password provided&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flash</span><span class="p">(</span><span class="s1">&#39;You were successfully logged in&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
       
    <span class="k">return</span>  <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
    <span class="c1"># remove the username from the session if it&#39;s there</span>
    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>以下是实现闪现的 <code>layout.html</code> 模板：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html"><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My Application<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">flashes</span><span class="p">&gt;</span>
    {% for category, message in messages %}
      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> class=&#34;{{ category }}&#34;&gt;{{ message }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    {% endfor %}
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
  {% endif %}
{% endwith %}
{% block body %}{% endblock %}
</code></pre></td></tr></table>
</div>
</div><p>以下是继承自 <code>layout.html</code> 的 <code>index.html</code> 模板：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% block body %}
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Overview<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Do you want to <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;{{ url_for(&#39;login&#39;) }}&#34;</span><span class="p">&gt;</span>log in?<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
{% endblock %}
</code></pre></td></tr></table>
</div>
</div><p>以下是同样继承自 <code>layout.html</code> 的 <code>login.html</code> 模板：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Html" data-lang="Html">{% extends &#34;layout.html&#34; %}
{% block body %}
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
  {% if error %}
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">error</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error:<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ error }}
  {% endif %}
  <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">post</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">dl</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">dt</span><span class="p">&gt;</span>Username:
      <span class="p">&lt;</span><span class="nt">dd</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">text</span> <span class="na">name</span><span class="o">=</span><span class="s">username</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;{{
</span><span class="s">          request.form.username }}&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">dt</span><span class="p">&gt;</span>Password:
      <span class="p">&lt;</span><span class="nt">dd</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">password</span> <span class="na">name</span><span class="o">=</span><span class="s">password</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">dl</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">submit</span> <span class="na">value</span><span class="o">=</span><span class="s">Login</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
{% endblock %}
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>The article was updated on 2020-03-13</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://ieblyang.tech/en/flask01/" data-title="结合官方文档 入门Flask" data-via="ieblYang" data-hashtags="Python,Flask"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://ieblyang.tech/en/flask01/" data-hashtag="Python"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://ieblyang.tech/en/flask01/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://ieblyang.tech/en/flask01/" data-title="结合官方文档 入门Flask" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://ieblyang.tech/en/flask01/" data-title="结合官方文档 入门Flask" data-image="/images/flask/featured-image.png" data-ralateuid="ieblYang"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="Share on 百度" data-sharer="baidu" data-url="https://ieblyang.tech/en/flask01/" data-title="结合官方文档 入门Flask"><i class="loveit it-baidu-fill"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://ieblyang.tech/en/flask01/" data-title="结合官方文档 入门Flask"><i class="fab fa-evernote fa-fw"></i></a><a href="javascript:void(0);" title="Share on Skype" data-sharer="skype" data-url="https://ieblyang.tech/en/flask01/" data-title="结合官方文档 入门Flask"><i class="fab fa-skype fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/en/tags/python">Python</a>,&nbsp;<a href="/en/tags/flask">Flask</a></section>
        <section>
            <span><a href="javascript:window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/en/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/en/face06/" class="prev" rel="prev" title="人脸检测业务理论及实现"><i class="fas fa-angle-left fa-fw"></i>人脸检测业务理论及实现</a>
            <a href="/en/face09/" class="next" rel="next" title="人脸匹配业务理论及实现">人脸匹配业务理论及实现<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div class="comment"><div id="valine"></div><script>
            document.addEventListener("DOMContentLoaded", function(event) {
                new Valine({
                    el: '#valine',
                    appId: 'kpgPchgfg6K9RMdLzdhxQyOV-gzGzoHsz',
                    appKey: 'erpDYbf9JmO61Yn1YtUw7AXB',placeholder: 'Your comment ...',verify: true,avatar: 'mp',pageSize: 10,lang: 'en',visitor: true,recordIP: true,});
            });
        </script>
        <noscript>
            Please enable JavaScript to view the <a href="https://valine.js.org/">comments powered by Valine.</a>
        </noscript></div>
    </article></div>
            </main><footer class="footer">
    <div class="copyright"><div class="copyright-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer"><i class="far fa-heart fa-fw"></i> LoveIt</a>
        </div>

        <div class="copyright-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/en/" target="_blank">ieblYang</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer>
</div><a href="#" class="dynamic-to-top animated faster" id="dynamic-to-top">
            <i class="fas fa-chevron-up fa-fw"></i>
        </a><script>
        document.addEventListener('DOMContentLoaded', function () {
            lightGallery(document.getElementById('content'), {
                selector: '.lightgallery',
                speed: 400,
                hideBarsDelay: 2000,
                thumbnail: true,
                exThumbImage: 'data-thumbnail',
                thumbWidth: 80,
                thumbContHeight: 80,
            });
        });
    </script><link rel="stylesheet" href="/lib/valine/valine.48fc8c7a134ff56a24e2e2d3106ec39a.css" integrity="md5-SPyMehNP9Wok4uLTEG7Dmg=="><link rel="stylesheet" href="/lib/iconfont/iconfont.min.60491d359fba28667d44b1b4c808a0bd.css" integrity="md5-YEkdNZ&#43;6KGZ9RLG0yAigvQ=="><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.f0e116a1a6b325059928a106254352e1.css" integrity="md5-8OEWoaazJQWZKKEGJUNS4Q=="><script src="/lib/valine/Valine.min.1698240d38b9277036a3059775e55a03.js" integrity="md5-FpgkDTi5J3A2owWXdeVaAw=="></script><script src="/lib/smooth-scroll/smooth-scroll.polyfills.min.c4f5974788ebb82890a0e7771763939c.js" integrity="md5-xPWXR4jruCiQoOd3F2OTnA=="></script><script src="/lib/sharer/sharer.min.c3c3372b4cf5c56dd4e5a4be8ada86c9.js" integrity="md5-w8M3K0z1xW3U5aS&#43;itqGyQ=="></script><script src="/lib/lazysizes/lazysizes.min.0812d0f17b90a4aefd97bb91085ad252.js" integrity="md5-CBLQ8XuQpK79l7uRCFrSUg=="></script><script src="/lib/lightgallery/lightgallery.min.4bc95325ef47ddceda10ae0ee66e925c.js" integrity="md5-S8lTJe9H3c7aEK4O5m6SXA=="></script><script src="/lib/lightgallery/lg-thumbnail.min.874045ba82acdc496e8c871b77c5c1e5.js" integrity="md5-h0BFuoKs3ElujIcbd8XB5Q=="></script><script src="/lib/lightgallery/lg-zoom.min.409e9d2da92a979799deed01377eeff6.js" integrity="md5-QJ6dLakql5eZ3u0BN37v9g=="></script><script src="/js/theme.min.2d8c56f0eeaac5b7d58911d3c7522b29.js" integrity="md5-LYxW8O6qxbfViRHTx1IrKQ=="></script></body>
</html>
